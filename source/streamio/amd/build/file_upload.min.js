define("mediatimesrc_streamio/file_upload",["exports","mediatimesrc_streamio/tus","core/log","core/config"],(function(_exports,tus,_log,_config){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}var upload;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,tus=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(tus),_log=_interopRequireDefault(_log);const options={endpoint:(_config=_interopRequireDefault(_config)).default.wwwroot+"/api/v1/videos/tus",metadata:{},onError:_log.default.debug,onProgress:function(bytesUploaded,bytesTotal){document.querySelectorAll(".progress").forEach((indicator=>{indicator.style.width=bytesUploaded/bytesTotal*100+"%"}))},onSuccess:function(){document.getElementById("upload_resource_form").submit(),_log.default.debug(upload.url)}};var _default={init:function(token){options.metadata.uploadtoken=token,document.body.removeEventListener("click",this.handleClick),document.body.addEventListener("click",this.handleClick)},handleClick:function(e){if(e.target.closest('button[name="upload"]')){const file=document.querySelector('input[name="streamiofile"]').files[0];e.preventDefault(),options.metadata.filename=file.name,options.metadata.filetype=file.type,_log.default.debug(options),_log.default.debug(tus),(upload=new tus.Upload(file,options)).start()}}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=file_upload.min.js.map